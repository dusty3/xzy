<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lpf.dao.StockDao">

    <insert id="saveStock" parameterType="Stock">
        <selectKey keyProperty="id" order="BEFORE" resultType="java.lang.Integer" >
            SELECT  shop_seq.nextval from dual
        </selectKey>

        INSERT  INTO SHOP.SHOP_STOCK(ID, P_ID, ADMIN_ID, STOCK_NUMBER)
        VALUES (#{id},#{pId},#{adminId},#{stockNumber})


    </insert>

    <resultMap id="stockMap" type="Stock">
        <id   property="id" column="id"></id>
        <result property="pId" column="P_ID"></result>
        <result property="adminId" column="ADMIN_ID"></result>
        <result property="stockNumber" column="STOCK_NUMBER"></result>
        <result property="stockUpdateTime" column="STOCK_UPDATE_TIME"></result>
    </resultMap>
    <insert id="saveInnerStock" parameterType="InnerStock">
        <selectKey keyProperty="id" order="BEFORE"  resultType="java.lang.Integer">
            SELECT  shop_seq.nextval from dual
        </selectKey>

        INSERT  INTO SHOP.SHOP_INNER_STOCK(ID, P_ID, ADMIN_ID, INNER_STOCK_NUMBER)

        VALUES (#{id},#{pId},#{adminId},#{innerStockNumber})
    </insert>
    <select id="findStockByPId" parameterType="java.lang.Integer" resultMap="stockMap">
        SELECT * from  SHOP.SHOP_STOCK WHERE P_ID=#{pId}
    </select>
    <update id="updateStock" parameterType="Stock">
        UPDATE SHOP.SHOP_STOCK SET   STOCK_NUMBER=#{stockNumber} WHERE P_ID=#{pId}
    </update>



</mapper>
